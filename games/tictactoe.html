<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe - Game Hub</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .fullscreen-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #fff;
            cursor: pointer;
            font-size: 1.2rem;
            z-index: 100;
        }
        .ttt-board {
            display: grid;
            grid-template-columns: repeat(3, 120px);
            gap: 10px;
            margin: 20px auto;
        }
        
        .ttt-cell {
            width: 120px;
            height: 120px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            font-size: 4rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
        }
        
        .ttt-cell:hover:not(.taken) {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }
        
        .ttt-cell.x {
            color: #00d9ff;
            text-shadow: 0 0 20px rgba(0, 217, 255, 0.5);
        }
        
        .ttt-cell.o {
            color: #ff6b6b;
            text-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
        }
        
        .ttt-cell.winning {
            background: rgba(0, 255, 136, 0.3);
            animation: pulse 0.5s ease infinite alternate;
        }
        
        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }
        
        .status {
            font-size: 1.5rem;
            text-align: center;
            margin: 20px 0;
            min-height: 40px;
        }
        
        .player-indicator {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 20px 0;
        }
        
        .player {
            padding: 10px 30px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0.5;
            transition: all 0.3s ease;
        }
        
        .player.active {
            opacity: 1;
            transform: scale(1.1);
        }
        
        .player.x { border: 2px solid #00d9ff; }
        .player.o { border: 2px solid #ff6b6b; }
        
        .difficulty-selection {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .difficulty-btn {
            padding: 8px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .difficulty-btn.active {
            background: #ff6b6b;
            border-color: #ff6b6b;
        }
        
        .stats {
            display: flex;
            gap: 30px;
            margin: 20px 0;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #00d9ff;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #a0a0a0;
        }
    </style>
</head>
<body>
    <button class="fullscreen-btn" id="fullscreenBtn">⛶</button>
    
    <div class="container">
        <a href="../index.html" class="back-btn">← Back to Games</a>
        
        <div class="game-container">
            <h1 class="game-title">⭕❌ Tic-Tac-Toe</h1>
            
            <div class="mode-selection">
                <button class="mode-btn active" data-mode="2player">2 Players</button>
                <button class="mode-btn" data-mode="ai">vs AI</button>
            </div>
            
            <div id="difficultyContainer" class="difficulty-selection hidden">
                <button class="difficulty-btn" data-difficulty="easy">Easy</button>
                <button class="difficulty-btn active" data-difficulty="medium">Medium</button>
                <button class="difficulty-btn" data-difficulty="hard">Hard</button>
            </div>
            
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="xWins">0</div>
                    <div class="stat-label">X Wins</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="draws">0</div>
                    <div class="stat-label">Draws</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="oWins">0</div>
                    <div class="stat-label">O Wins</div>
                </div>
            </div>
            
            <div class="player-indicator">
                <div class="player x active" id="playerX">Player X</div>
                <div class="player o" id="playerO">Player O</div>
            </div>
            
            <div class="status" id="status">Player X's turn</div>
            
            <div class="ttt-board" id="board">
                <div class="ttt-cell" data-cell="0"></div>
                <div class="ttt-cell" data-cell="1"></div>
                <div class="ttt-cell" data-cell="2"></div>
                <div class="ttt-cell" data-cell="3"></div>
                <div class="ttt-cell" data-cell="4"></div>
                <div class="ttt-cell" data-cell="5"></div>
                <div class="ttt-cell" data-cell="6"></div>
                <div class="ttt-cell" data-cell="7"></div>
                <div class="ttt-cell" data-cell="8"></div>
            </div>
            
            <button id="resetBtn" class="btn btn-primary">New Game</button>
            
            <div class="instructions">
                <h3>How to Play</h3>
                <p>Take turns placing X and O on the board.<br>
                Get three in a row to win!<br>
                Play against a friend or the AI.</p>
            </div>
        </div>
    </div>

    <script>
        // Fullscreen
        document.getElementById('fullscreenBtn').addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        });

        const cells = document.querySelectorAll('.ttt-cell');
        const status = document.getElementById('status');
        const resetBtn = document.getElementById('resetBtn');
        const modeButtons = document.querySelectorAll('.mode-btn');
        const difficultyContainer = document.getElementById('difficultyContainer');
        const difficultyButtons = document.querySelectorAll('.difficulty-btn');
        const playerXEl = document.getElementById('playerX');
        const playerOEl = document.getElementById('playerO');
        
        let board = ['', '', '', '', '', '', '', '', ''];
        let currentPlayer = 'X';
        let gameActive = true;
        let gameMode = '2player';
        let difficulty = 'medium';
        let stats = { X: 0, O: 0, draws: 0 };
        
        const winPatterns = [
            [0, 1, 2], [3, 4, 5], [6, 7, 8],
            [0, 3, 6], [1, 4, 7], [2, 5, 8],
            [0, 4, 8], [2, 4, 6]
        ];
        
        function updatePlayerIndicator() {
            playerXEl.classList.toggle('active', currentPlayer === 'X');
            playerOEl.classList.toggle('active', currentPlayer === 'O');
        }
        
        function checkWinner() {
            for (const pattern of winPatterns) {
                const [a, b, c] = pattern;
                if (board[a] && board[a] === board[b] && board[a] === board[c]) {
                    return { winner: board[a], pattern };
                }
            }
            if (!board.includes('')) return { winner: 'draw', pattern: null };
            return null;
        }
        
        function handleCellClick(e) {
            const cell = e.target;
            const index = parseInt(cell.dataset.cell);
            
            if (board[index] || !gameActive) return;
            if (gameMode === 'ai' && currentPlayer === 'O') return;
            
            makeMove(index);
        }
        
        function makeMove(index) {
            board[index] = currentPlayer;
            cells[index].textContent = currentPlayer;
            cells[index].classList.add(currentPlayer.toLowerCase(), 'taken');
            
            const result = checkWinner();
            if (result) {
                endGame(result);
                return;
            }
            
            currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
            updatePlayerIndicator();
            status.textContent = `Player ${currentPlayer}'s turn`;
            
            if (gameMode === 'ai' && currentPlayer === 'O' && gameActive) {
                status.textContent = 'AI is thinking...';
                setTimeout(aiMove, 500);
            }
        }
        
        function aiMove() {
            if (!gameActive) return;
            
            let move;
            switch (difficulty) {
                case 'easy':
                    move = getRandomMove();
                    break;
                case 'medium':
                    move = Math.random() > 0.5 ? getBestMove() : getRandomMove();
                    break;
                case 'hard':
                    move = getBestMove();
                    break;
            }
            
            if (move !== null) {
                makeMove(move);
            }
        }
        
        function getRandomMove() {
            const emptyCells = board.map((cell, i) => cell === '' ? i : null).filter(i => i !== null);
            return emptyCells[Math.floor(Math.random() * emptyCells.length)];
        }
        
        function getBestMove() {
            // Try to win
            for (const pattern of winPatterns) {
                const move = findWinningMove(pattern, 'O');
                if (move !== null) return move;
            }
            
            // Block player
            for (const pattern of winPatterns) {
                const move = findWinningMove(pattern, 'X');
                if (move !== null) return move;
            }
            
            // Take center
            if (board[4] === '') return 4;
            
            // Take corners
            const corners = [0, 2, 6, 8].filter(i => board[i] === '');
            if (corners.length) return corners[Math.floor(Math.random() * corners.length)];
            
            // Take any
            return getRandomMove();
        }
        
        function findWinningMove(pattern, player) {
            const [a, b, c] = pattern;
            const cells = [board[a], board[b], board[c]];
            const playerCount = cells.filter(c => c === player).length;
            const emptyCount = cells.filter(c => c === '').length;
            
            if (playerCount === 2 && emptyCount === 1) {
                if (board[a] === '') return a;
                if (board[b] === '') return b;
                if (board[c] === '') return c;
            }
            return null;
        }
        
        function endGame(result) {
            gameActive = false;
            
            if (result.winner === 'draw') {
                status.textContent = "It's a draw!";
                stats.draws++;
            } else {
                status.textContent = `Player ${result.winner} wins!`;
                stats[result.winner]++;
                result.pattern.forEach(i => cells[i].classList.add('winning'));
            }
            
            updateStats();
        }
        
        function updateStats() {
            document.getElementById('xWins').textContent = stats.X;
            document.getElementById('oWins').textContent = stats.O;
            document.getElementById('draws').textContent = stats.draws;
        }
        
        function resetGame() {
            board = ['', '', '', '', '', '', '', '', ''];
            currentPlayer = 'X';
            gameActive = true;
            status.textContent = "Player X's turn";
            
            cells.forEach(cell => {
                cell.textContent = '';
                cell.className = 'ttt-cell';
            });
            
            updatePlayerIndicator();
        }
        
        // Event Listeners
        cells.forEach(cell => cell.addEventListener('click', handleCellClick));
        resetBtn.addEventListener('click', resetGame);
        
        modeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                modeButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                gameMode = btn.dataset.mode;
                
                difficultyContainer.classList.toggle('hidden', gameMode !== 'ai');
                playerOEl.textContent = gameMode === 'ai' ? 'AI (O)' : 'Player O';
                
                resetGame();
            });
        });
        
        difficultyButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                difficultyButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                difficulty = btn.dataset.difficulty;
                resetGame();
            });
        });
    </script>
    <script src="../js/accounts.js"></script>
</body>
</html>
